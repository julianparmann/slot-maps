<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SlotMaps - AP Slot Machines</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        /* Basic reset */
        body, html {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        /* Container for AP tiles */
        #ap-machine-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
        }

        /* Tile styles */
        .ap-tile {
            width: 300px; /* Fixed width for each card */
            height: auto;
            margin: 10px;
            position: relative; /* Allows absolute positioning of inner elements */
            background-color: #fff; /* Adds background color */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Light shadow effect */
            border-radius: 10px; /* Rounded corners */
            transition: transform 0.3s ease-in-out; /* Smooth transition on hover */
        }

        .ap-tile:hover .machine-ratings {
            visibility: visible;
            opacity: 1;
        }
        .header {
        position: relative;
        background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent black */
        top: 0; /* Aligns header at the very top */
        left: 0;
        width: 100%; /* Makes the header span the full width */
        padding: 20px; /* Adds padding for spacing around content */
        color: white; /* Ensures text is visible */
        z-index: 2; /* Places header above the video */
        display: flex;
        align-items: center;
        justify-content: flex-start; /* Aligns logo and text to the left */
        }
        
        .logo {
        width: 50px; /* Adjust this size as needed */
        height: auto; /* Maintains the logo's aspect ratio */
        margin-right: 10px; /* Adds some space between logo and text */
    }
    
    .welcome-message {
        font-size: 1.5em; /* Adjusts text size */
    }

        .machine-image {
            background-size: cover;
            background-position: center;
            width: 100%;
            height: 200px; /* Adjust the height as needed */
            border-radius: 10px 10px 0 0; /* Rounded corners at the top */
            position: relative; /* To ensure text and bars appear on top of the image */
        }

        .machine-name {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white; /* Makes the text white */
            font-weight: bold; /* Makes the text bold */
            font-size: 1.5em; /* Adjust the size as needed */
            z-index: 2; /* Ensures the text is above the image */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Adds a subtle shadow for readability */
        }

        /* Rating bars */
        .machine-ratings {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60%;
            padding: 5px; /* Reduced padding */
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease-in-out;
            z-index: 3; /* Ensure bars appear on top of the image */
            background-color: rgba(0, 0, 0, 0.6); /* Semi-transparent background for better readability */
            border-radius: 15px; /* Rounded corners for the entire container */
            overflow: hidden; /* Ensures the contents are within the rounded area */
        }

        .rating-bar {
            background-color: #f1f1f1;
            border-radius: 15px;
            overflow: hidden;
            margin-top: 3px; /* Reduced margin */
        }

        .rating-label {
            padding-left: 10px; /* Add some padding to the left */
            display: inline-block; /* Ensure proper spacing inside the box */
        }

        .bar {
            height: 10px; /* Reduced height */
            border-radius: 15px;
            background-color: #ccc;
        }

        /* Popup overlay */
        #popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1000;
        }

        /* Popup content */
        #popup-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            width: 300px;
            text-align: center;
            z-index: 1001;
        }

        /* Close button for popup */
        #close-popup {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
            cursor: pointer;
        }
    </style>
</head>
<body>
<header class="header">
    <img src="/logo.png" alt="SlotMaps Logo" class="logo">
    <h1 class="welcome-message">SlotMaps AP Guide Marketplace</h1>
</header>
    <!-- Container for AP Slot Machine tiles -->
    <div id="ap-machine-container" class="ap-grid"></div>

    <!-- Popup Overlay and Content -->
    <div id="popup-overlay">
        <div id="popup-content">
            <span id="close-popup">&times;</span>
            <h2>Join Our Community</h2>
            <p>Want this map? Join now and access 22 Las Vegas Casino Maps and X slot machines that are beatable.</p>
            <a href="https://form.jotform.com/242934403310042">Join Now</a><br><br>
            <a href="/apguides.html">Or Buy a Guide for $29.99</a>
        </div>
    </div>

    <!-- Script to load data from Google Sheets using Papa Parse and handle popups -->
    <script>
      window.onload = function() {
        var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQFH3hXgs8ThLLYcOdWpctJotOid42a5TQbmC3CiBck0o-sVJg_5jfdVS_8NHiEx3renedTlyBzlH4W/pub?output=csv';

        function init() {
          Papa.parse(publicSpreadsheetUrl, {
            download: true,
            header: true,
            complete: function(results) {
              var data = results.data;
              showMachines(data);
            }
          });
        }

        function showMachines(data) {
          data.forEach(function(machine) {
            var machineCard = `
              <div class="ap-tile" onclick="showPopup()">
                <div class="machine-image" style="background-image: url('${machine.Photo}');">
                  <div class="machine-name">${machine['Machine Name']}</div>
                </div>
                <div class="machine-ratings">
                  <div class="rating-bar">
                    <span class="rating-label">Overall Value</span>
                    <div class="bar" style="width: ${machine['Overall Value']}%; background-color: ${getBarColor(machine['Overall Value'])};"></div>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">Commonness</span>
                    <div class="bar" style="width: ${machine.Commonness}%; background-color: ${getBarColor(machine.Commonness)};"></div>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">Variance</span>
                    <div class="bar" style="width: ${machine.Variance}%; background-color: ${getBarColor(machine.Variance)};"></div>
                  </div>
                  <div class="rating-bar">
                    <span class="rating-label">High Stakes Availability</span>
                    <div class="bar" style="width: ${machine['High Stakes Availability']}%; background-color: ${getBarColor(machine['High Stakes Availability'])};"></div>
                  </div>
                </div>
              </div>
            `;
            document.getElementById('ap-machine-container').innerHTML += machineCard;
          });

          document.querySelectorAll('.ap-tile').forEach(card => {
            card.addEventListener('click', showPopup);
          });
        }

        function getBarColor(value) {
          if (value >= 80) return 'green';
          if (value >= 50) return '#f4a742';
          return 'red';
        }

        function showPopup() {
          document.getElementById('popup-overlay').style.display = 'block';
          document.getElementById('popup-content').style.display = 'block';
        }

        function hidePopup() {
          document.getElementById('popup-overlay').style.display = 'none';
          document.getElementById('popup-content').style.display = 'none';
        }

        document.getElementById('close-popup').addEventListener('click', hidePopup);
        document.getElementById('popup-overlay').addEventListener('click', function(event) {
          if (event.target === this) hidePopup();
        });

        init();
      }
    </script>

</body>
</html>
